<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智慧農業生產數據監測系統</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #fff7e6; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; }
        .container { max-width: 1200px; width: 100%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); border-radius: 12px; overflow: hidden; margin-top: 2rem; margin-bottom: 2rem; }
        .page-content { padding: 2rem; min-height: 700px; display: none; }
        .page-content.active { display: block; }
        .nav-button { transition: all 0.2s ease-in-out; }
        .nav-button:hover { background-color: #047857; }
        .nav-button.active { background-color: #047857; font-weight: 600; }
        .carousel-container { position: relative; overflow: hidden; border-radius: 8px; }
        .carousel-track { display: flex; transition: transform 0.5s ease-in-out; }
        .carousel-slide { min-width: 100%; box-sizing: border-box; display: flex; justify-content: center; align-items: center; height: 300px; background-size: cover; background-position: center; color: white; font-size: 2rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .carousel-dot { width: 10px; height: 10px; background-color: rgba(255, 255, 255, 0.5); border-radius: 50%; cursor: pointer; margin: 0 5px; transition: background-color 0.3s; }
        .carousel-dot.active { background-color: white; }
        .chart-placeholder { min-height: 200px; background-color: #e0e7ff; border: 1px solid #c7d2fe; border-radius: 8px; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #4338ca; font-weight: 500; text-align: center; padding: 1rem; }
        .gauge-container { width: 120px; height: 120px; border-radius: 50%; background-color: #cbd5e1; display: flex; justify-content: center; align-items: center; position: relative; overflow: hidden; margin: auto; }
        .gauge-fill { position: absolute; bottom: 0; left: 0; width: 100%; background-color: #22c55e; height: 50%; transition: height 0.5s ease-out, background-color 0.5s ease-out; }
        .gauge-value { position: relative; z-index: 10; font-size: 1.5rem; font-weight: bold; color: #334155; }
        .gauge-label { position: absolute; top: 10px; font-size: 0.8rem; color: #64748b; }
        @media (min-width: 640px) { .feature-cards-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 768px) { .feature-cards-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (min-width: 1024px) { .feature-cards-grid { grid-template-columns: repeat(5, 1fr); } }
    </style>
</head>
<body class="bg-[#fff7e6] antialiased">
    <div class="container rounded-xl shadow-lg my-8 md:my-12">
        <!-- Navigation Bar -->
        <nav class="p-4 rounded-t-xl shadow-md" style="background-image: url('https://raw.githubusercontent.com/Evonne-yu/SmartFarming/refs/heads/main/frontpage.jpg'); background-size: cover; background-position: center;">
    <ul class="flex flex-wrap justify-center gap-2 md:gap-4">
            <ul class="flex flex-wrap justify-center gap-2 md:gap-4">
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50 active" onclick="showPage('home')">首頁</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('dashboard')">即時監測儀表板</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('automation')">智慧農業自動化控制</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('crop-management')">農作物生長管理區</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('reports-prediction')">分析報表與預測系統</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('settings')">系統設定與管理</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('mobile-design')">手機/平板互動設計</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('ai-chatbot')">AI客服Robot</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('anomaly-notification')">異常通知</button></li>
            </ul>
        </nav>
        
        <!-- =================================================================== -->
        <!-- =================== ALL PAGE CONTENT (HTML PART) ================== -->
        <!-- =================================================================== -->
        <!-- Page 1: 首頁 Home -->
        <div id="home" class="page-content active"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">智慧農業生產數據監測系統</h1><p class="text-lg text-gray-600 mb-8 text-center">讓農業生產更智慧、更高效！</p><section class="mb-10"><h2 class="text-2xl font-semibold text-gray-700 mb-4">系統簡介</h2><div class="carousel-container h-64 md:h-80"><div class="carousel-track" id="home-carousel-track"><div class="carousel-slide" style="background-image: url('https://raw.githubusercontent.com/Evonne-yu/SmartFarming/refs/heads/main/smart-farming1.jpg');"><span class="bg-black bg-opacity-50 p-2 rounded-md">智慧農場全景</span></div><div class="carousel-slide" style="background-image: url('https://raw.githubusercontent.com/Evonne-yu/SmartFarming/refs/heads/main/smart-farming2.jpg');"><span class="bg-black bg-opacity-50 p-2 rounded-md">先進感測器部署</span></div><div class="carousel-slide" style="background-image: url('https://raw.githubusercontent.com/Evonne-yu/SmartFarming/refs/heads/main/smart-farming3.jpg');"><span class="bg-black bg-opacity-50 p-2 rounded-md">自動化灑水系統</span></div></div><div class="absolute bottom-4 left-0 right-0 flex justify-center space-x-2" id="home-carousel-dots"><span class="carousel-dot active" data-slide="0"></span><span class="carousel-dot" data-slide="1"></span><span class="carousel-dot" data-slide="2"></span></div></div></section><section class="mb-10"><h2 class="text-2xl font-semibold text-gray-700 mb-4">主要功能總覽</h2><div class="grid feature-cards-grid gap-6"><div class="bg-indigo-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('dashboard')"><div class="text-4xl mb-3 text-indigo-700">📊</div><h3 class="text-xl font-medium text-indigo-800">即時監測</h3><p class="text-gray-600 text-sm">掌握農場即時數據</p></div><div class="bg-green-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('dashboard')"><div class="text-4xl mb-3 text-green-700">🌱</div><h3 class="text-xl font-medium text-green-800">環境感測</h3><p class="text-gray-600 text-sm">溫度、濕度、土壤一覽無遺</p></div><div class="bg-red-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('automation')"><div class="text-4xl mb-3 text-red-700">⚙️</div><h3 class="text-xl font-medium text-red-800">自動化控制</h3><p class="text-gray-600 text-sm">智能管理灑水、通風</p></div><div class="bg-yellow-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('crop-management')"><div class="text-4xl mb-3 text-yellow-700">🌾</div><h3 class="text-xl font-medium text-yellow-800">農作管理</h3><p class="text-gray-600 text-sm">作物生長與照片記錄</p></div><div class="bg-purple-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('reports-prediction')"><div class="text-4xl mb-3 text-purple-700">📈</div><h3 class="text-xl font-medium text-purple-800">報表與預測分析</h3><p class="text-gray-600 text-sm">數據洞察，輔助決策</p></div></div></section><section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10"><div class="bg-blue-50 p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-blue-700 mb-4">今日天氣與預測</h2><p class="text-gray-700 text-lg mb-2">農場地點：台中市后里區</p><p id="weather-temp" class="text-gray-700 text-3xl font-bold">28°C ☀️</p><p id="weather-humidity" class="text-gray-600">濕度 75%</p><p id="weather-rain" class="text-gray-600">降雨機率 10%</p><p id="weather-forecast" class="text-gray-600 text-sm mt-2">預計明日：多雲，26°C - 32°C</p></div><div class="bg-gray-50 p-6 rounded-lg shadow-md flex flex-col justify-between"><div><h2 class="text-2xl font-semibold text-gray-700 mb-4">快速入口</h2><button class="w-full bg-blue-500 text-white py-3 rounded-md mb-3 hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="showPage('dashboard')">快速進入數據儀表板</button></div><div><p class="text-center text-gray-600 mb-2">已有帳號？</p><button class="w-full border border-blue-500 text-blue-500 py-3 rounded-md hover:bg-blue-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="alert('模擬登入操作...');">登入</button><p class="text-center text-gray-600 mt-3 mb-2">還沒有帳號？</p><button class="w-full bg-blue-700 text-white py-3 rounded-md hover:bg-blue-800 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-700" onclick="alert('模擬註冊操作...');">註冊</button></div></div></section></div>
        <!-- (...其他頁面內容...) -->
        <!-- Page 7: 手機版 / 平板互動設計 --><div id="mobile-design" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">手機 / 平板互動設計</h1><p class="text-lg text-gray-600 mb-8 text-center">專為行動裝置優化，隨時隨地輕鬆管理</p>
            <!-- 主要修改處 -->
            <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h2 class="text-2xl font-semibold text-gray-700 mb-4">響應式設計</h2>
                <p class="text-gray-700 mb-3">此系統採用 Tailwind CSS 框架，確保頁面在不同尺寸的螢幕上（手機、平板、桌面）都能自動調整佈局和元素大小，提供最佳的視覺體驗。</p>
                <div class="flex justify-center items-center gap-6 flex-wrap">
                    <!-- 手機視圖 -->
                    <img src="https://raw.githubusercontent.com/Evonne-yu/SmartFarming/main/mobile-view.png" alt="手機視圖" class="h-48 md:h-56 rounded-lg shadow-md border border-gray-200">
                    <!-- 平板視圖 -->
                    <img src="https://raw.githubusercontent.com/Evonne-yu/SmartFarming/main/tablet-view.png" alt="平板視圖" class="h-48 md:h-56 rounded-lg shadow-md border border-gray-200">
                    <!-- 桌面視圖 -->
                    <img src="https://raw.githubusercontent.com/Evonne-yu/SmartFarming/main/desktop-view.png" alt="桌面視圖" class="h-48 md:h-56 rounded-lg shadow-md border border-gray-200">
                </div>
                <p class="text-sm text-gray-500 mt-4">描述：圖片展示了網頁在不同設備上的適應性。</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md mb-8"><h2 class="text-2xl font-semibold text-gray-700 mb-4">功能重點 (行動版)</h2><ul class="list-disc list-inside text-gray-700 space-y-3"><li><strong class="text-blue-700">圖片與數據同步切換:</strong> 在手機或平板上瀏覽田間照片時，點擊圖片會自動疊加顯示該照片拍攝時的環境數據（如氣溫、濕度、日照等），提供更直觀的上下文資訊。</li><li><strong class="text-blue-700">地圖點擊 + 拍照上傳功能 (巡檢回報):</strong> 農場巡檢人員可直接在行動裝置的地圖介面上點擊任一感測點或區域，並利用手機攝像頭即時拍照上傳，同時附帶文字備註，用於記錄異常狀況或作物生長情況，即時回報至系統。<button class="ml-2 bg-blue-100 text-blue-700 px-3 py-1 rounded-md text-sm hover:bg-blue-200" onclick="alert('模擬開啟相機並上傳照片至地圖點位...');">模擬拍照上傳</button></li><li><strong class="text-blue-700">推播功能 (異常警報):</strong> 當系統監測到異常情況（如高溫、乾旱警報、設備故障）時，會立即透過行動應用程式或網頁瀏覽器向管理員和相關農夫推播通知，確保問題能被迅速發現與處理。<button class="ml-2 bg-red-100 text-red-700 px-3 py-1 rounded-md text-sm hover:bg-red-200" onclick="alert('模擬發送異常警報推播通知：\n「警告！溫室1號溫度過高 (38°C)。」');">模擬推播警報</button></li><li><strong class="text-blue-700">簡化操作介面:</strong> 行動版介面會針對觸控操作進行優化，按鈕和輸入框更大，流程更簡潔，方便單手操作。</li><li><strong class="text-blue-700">離線數據緩存 (概念):</strong> 考慮到農場可能網路不穩，未來可實作部分數據離線緩存功能，確保在無網路情況下仍能查看基礎數據和記錄。</li></ul></div><div class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">預期效益</h2><p class="text-gray-700">行動版設計將極大提升系統的實用性和便捷性，讓農場管理人員能夠隨時隨地掌握農場狀況，快速響應問題，實現真正的智慧化農業生產。</p></div></div>
        <!-- (...其他頁面內容...) -->
    </div>

    <!-- =================================================================== -->
    <!-- ============ 我是驅動所有互動功能的核心 JavaScript ============== -->
    <!-- =================================================================== -->
    <script>
        let currentActiveDevice=null,deviceStatuses={ "灑水器 A":"開啟","排風扇 1":"關閉","LED 補光燈 2":"自動"};function getCurrentFormattedTime(){const e=new Date,t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getDate().toString().padStart(2,"0"),a=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0");return`${t}-${n}-${o} ${a}:${i}`}function showPage(e){document.querySelectorAll(".page-content").forEach(e=>{e.classList.remove("active")}),document.getElementById(e).classList.add("active"),document.querySelectorAll(".nav-button").forEach(t=>{t.classList.remove("active"),t.getAttribute("onclick")===`showPage('${e}')`&&t.classList.add("active")}),"dashboard"===e&&updateDashboardCharts()}let currentSlide=0;const carouselTrack=document.getElementById("home-carousel-track"),carouselDotsContainer=document.getElementById("home-carousel-dots"),totalSlides=carouselTrack?carouselTrack.children.length:0;function updateCarousel(){carouselTrack&&(carouselTrack.style.transform=`translateX(-${100*currentSlide}%)`,carouselDotsContainer.querySelectorAll(".carousel-dot").forEach((e,t)=>{e.classList.toggle("active",t===currentSlide)}))}function nextSlide(){currentSlide=(currentSlide+1)%totalSlides,updateCarousel()}function startCarousel(){totalSlides>0&&setInterval(nextSlide,5e3)}carouselDotsContainer&&carouselDotsContainer.querySelectorAll(".carousel-dot").forEach(e=>{e.addEventListener("click",e=>{currentSlide=parseInt(e.target.dataset.slide),updateCarousel()})});function updateWeather(){const e=(25+5*Math.random()).toFixed(1),t=(60+20*Math.random()).toFixed(0),n=(30*Math.random()).toFixed(0),o=e>28?"☀️":"☁️";document.getElementById("weather-temp").innerText=`${e}°C ${o}`,document.getElementById("weather-humidity").innerText=`濕度 ${t}%`,document.getElementById("weather-rain").innerText=`降雨機率 ${n}%`,document.getElementById("weather-forecast").innerText=`預計明日：${Math.random()>.5?"晴時多雲":"局部陣雨"}，${(parseFloat(e)-2).toFixed(0)}°C - ${(parseFloat(e)+3).toFixed(0)}°C`}function updateDashboardCharts(){const e="all"===document.getElementById("sensor-select").value?1:Math.random()+.5;document.getElementById("current-temp").innerText=(25+5*Math.random()*e).toFixed(1),document.querySelector("#temp-chart .bg-blue-500").style.width=`${30*Math.random()+50}%`,document.getElementById("current-soil-moisture").innerText=(50+25*Math.random()*e).toFixed(0),document.querySelectorAll("#soil-moisture-chart .h-12").forEach(e=>{const t=(50+25*Math.random()).toFixed(0);e.style.backgroundColor=`hsl(120, 60%, ${70-.8*(t-50)}%)`,e.innerText=`${e.innerText.split(" ")[0]} ${t}%`}),document.getElementById("current-sunlight").innerText=(5e3+5e3*Math.random()*e).toFixed(0),document.querySelectorAll("#sunlight-chart .h-24 div").forEach(e=>{e.style.height=`${60*Math.random()+30}%`});const t=(400+300*Math.random()*e).toFixed(0);document.getElementById("co2-value").innerText=`${t} ppm`;const n=document.getElementById("co2-gauge-fill");n.style.height=`${Math.min(100,(t-300)/4)}%`;let o="#22c55e";t>650?o="#ef4444":t>550&&(o="#facc15"),n.style.backgroundColor=o}function showSensorDetail(e,t){alert(`感測點 ${e} 詳細數據:\n${t}`)}function showControlModal(e){const t=e.dataset.device,n=deviceStatuses[t]||"未知";currentActiveDevice=e,document.getElementById("modalTitle").innerText=`${t} 控制`,document.getElementById("modalDeviceName").innerText=t,document.getElementById("modalDeviceStatus").innerText=n,document.getElementById("controlModal").classList.remove("hidden")}function hideControlModal(){document.getElementById("controlModal").classList.add("hidden"),currentActiveDevice=null}function controlDevice(e){currentActiveDevice&&(deviceStatuses[currentActiveDevice.dataset.device]=e,currentActiveDevice.title=`${currentActiveDevice.dataset.device} (狀態: ${e})`,addOperationHistory(currentActiveDevice.dataset.device,e,document.querySelector('input[name="control-mode"]:checked').value),alert(`${currentActiveDevice.dataset.device} 已 ${e}！`),hideControlModal())}function addOperationHistory(e,t,n){const o=document.getElementById("operation-history-table").insertRow(0);o.innerHTML=`\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${getCurrentFormattedTime()}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${e}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm ${"開啟"===t?"text-green-600":"text-red-600"}">${t}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${n}</td>\n            `}function saveAutomationCondition(){const e=document.getElementById("condition1-param").selectedOptions[0].text,t=document.getElementById("condition1-op").value,n=document.getElementById("condition1-value").value,o=document.getElementById("action-device").selectedOptions[0].text;alert(`自動化條件已儲存：\n當 ${e} ${t} ${n}，則「${o}」。`)}function saveCropRecord(e,t){""!==t.trim()?alert(`${e} 的農作記錄已儲存：\n"${t}"`):alert(`請輸入 ${e} 的農作記錄內容。`)}function showImageDetail(e,t,n){document.getElementById("modalImage").src=e,document.getElementById("modalImageDate").innerText=`日期: ${t}`,document.getElementById("modalImageData").innerText=`數據: ${n}`,document.getElementById("imageDetailModal").classList.remove("hidden")}function hideImageDetailModal(){document.getElementById("imageDetailModal").classList.add("hidden")}function simulateGifGeneration(){alert("正在生成作物週成長GIF紀錄，這可能需要一些時間..."),setTimeout(()=>{alert("作物週成長GIF紀錄已生成並可下載！(模擬下載)")},3e3)}function simulateReportDownload(e){const t=document.getElementById("report-type").value,n=document.getElementById("report-start-date").value,o=document.getElementById("report-end-date").value;alert(`正在生成 ${n} 至 ${o} 的「${t}」${e} 報表...\n請稍候...`),setTimeout(()=>{alert(`「${t}」 ${e} 報表已生成並下載完成！`)},2e3)}function updatePredictions(){const e=(1e3+1e3*Math.random()).toFixed(0),t=Math.random()>.5?"上升":"下降";document.getElementById("predicted-irrigation").innerText=e,document.getElementById("predicted-irrigation-value").innerText=`${e} 公升/公頃`,document.getElementById("irrigation-trend").innerText=t;const n=(4.5+1.5*Math.random()).toFixed(1),o=(80+15*Math.random()).toFixed(0);document.getElementById("predicted-yield").innerText=n,document.getElementById("predicted-yield-value").innerText=`${n} 噸/公頃`,document.getElementById("yield-accuracy").innerText=`${o}`,document.getElementById("yield-accuracy-value").innerText=`${o}%`,alert("預測數據已更新！")}let users=[{name:"陳大農",role:"農夫",email:"chen@farm.com"},{name:"王技師",role:"技師",email:"wang@tech.com"},{name:"李經理",role:"管理者",email:"li@admin.com"}];function renderUsersTable(){const e=document.getElementById("user-management-table");e.innerHTML="";users.forEach(t=>{const n={農夫:"text-green-600",技師:"text-blue-600",管理者:"text-purple-600"}[t.role]||"",o=e.insertRow();o.innerHTML=`\n                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${t.name}</td>\n                    <td class="px-6 py-4 whitespace-nowrap text-sm ${n}">${t.role}</td>\n                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${t.email}</td>\n                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">\n                        <a href="#" class="text-indigo-600 hover:text-indigo-900 mr-4" onclick="editUser('${t.name}'); return false;">編輯</a>\n                        <a href="#" class="text-red-600 hover:text-red-900" onclick="deleteUser('${t.name}'); return false;">刪除</a>\n                    </td>\n                `})}function addUser(){const e=prompt("請輸入新使用者的姓名:");if(e){if(users.some(t=>t.name===e))return void alert("錯誤：此使用者名稱已存在！");const t=prompt(`請輸入 ${e} 的角色 (農夫/技師/管理者):`,"農夫");if(t){const n=prompt(`請輸入 ${e} 的電子郵件:`);n&&(users.push({name:e,role:t,email:n}),renderUsersTable(),alert(`使用者 ${e} (${t}) 已新增。`))}}}function editUser(e){const t=users.findIndex(t=>t.name===e);if(-1!==t){const n=users[t],o=prompt(`編輯 ${e} 的角色 (目前: ${n.role})，請輸入新角色:`,n.role);if(o){const a=prompt(`編輯 ${e} 的電子郵件 (目前: ${n.email})，請輸入新電子郵件:`,n.email);a&&(users[t]={...n,role:o,email:a},renderUsersTable(),alert(`使用者 ${e} 的資料已更新。`))}}}function deleteUser(e){confirm(`確定要刪除使用者 ${e} 嗎？`)&&(users=users.filter(t=>t.name!==e),renderUsersTable(),alert(`使用者 ${e} 已刪除。`))}function addMaintenanceRecord(){const e=prompt("請輸入感測器ID (例如: SENS-007):");if(e){const t=prompt("請輸入維護內容:");if(t){const n=document.getElementById("sensor-maintenance-table").insertRow(0);n.innerHTML=`\n                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${e}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${getCurrentFormattedTime().split(" ")[0]}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${t}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">正常</td>\n            `,alert(`感測器 ${e} 的維護記錄已新增。`)}}}function uploadFarmMap(e){const t=e.target.files[0];t&&alert(`已選取檔案: ${t.name}。\n(模擬上傳農場地圖)`)}function sendChatMessage(){const e=document.getElementById("chat-input"),t=e.value.trim();if(""!==t){const n=document.getElementById("chat-messages");n.innerHTML+=`<div class="flex justify-end"><div class="bg-emerald-100 text-emerald-800 px-4 py-2 rounded-lg max-w-xs">${t}</div></div>`,e.value="",n.scrollTop=n.scrollHeight,setTimeout(()=>{let e="對不起，我還在學習中，目前無法理解您的問題。";t.includes("溫度")||t.includes("氣溫")?e="目前的平均氣溫是 28.5°C。您可以前往「即時監測儀表板」查看詳細數據。":t.includes("灑水")||t.includes("灌溉")?e="您想自動灑水還是手動控制？請到「智慧農業自動化控制」頁面進行操作。":t.includes("收成")||t.includes("預測")?e="根據最新的模型，預測本季玉米收成量約為 5.2 噸/公頃。更多資訊請看「分析報表與預測系統」。":t.includes("你好")||t.includes("哈囉")&&(e="您好！很高興為您服務。"),n.innerHTML+=`<div class="flex justify-start"><div class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg max-w-xs">${e}</div></div>`,n.scrollTop=n.scrollHeight},1e3)}}function saveLineSettings(){const e=document.getElementById("line-channel-id").value;if(!e)return void alert("請至少填寫 Line Channel ID。");const t=document.getElementById("enable-line-notify").checked;alert(`Line@ 串接設定已儲存：\nChannel ID: ${e}\n啟用通知: ${t?"是":"否"}\n(Secret 和 Token 已於後端安全儲存)`)}function resetLineSettings(){confirm("確定要重設所有 Line@ 串接設定嗎？")&&(document.getElementById("line-channel-id").value="",document.getElementById("line-channel-secret").value="",document.getElementById("line-access-token").value="",document.getElementById("enable-line-notify").checked=!1,alert("Line@ 串接設定已重設。"))}function testLineNotification(){document.getElementById("line-channel-id").value?alert("正在發送測試通知至您的 Line 帳號...\n(模擬發送成功，請檢查您的 Line)"):alert("請先填寫並儲存 Line Channel ID。")}window.onload=function(){startCarousel(),updateWeather(),setInterval(updateWeather,6e4),setInterval(updateDashboardCharts,5e3),showPage("home"),renderUsersTable(),document.getElementById("chat-input").addEventListener("keypress",function(e){"Enter"===e.key&&sendChatMessage()})};
    </script>
</body>
</html>
