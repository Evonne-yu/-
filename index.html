<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智慧農業生產數據監測系統</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8f9fa; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; }
        .container { max-width: 1200px; width: 100%; background-color: #ffffff; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); border-radius: 12px; overflow: hidden; margin-top: 2rem; margin-bottom: 2rem; }
        .page-content { padding: 2rem; min-height: 700px; display: none; }
        .page-content.active { display: block; }
        .nav-button { transition: all 0.2s ease-in-out; }
        .nav-button:hover { background-color: #047857; }
        .nav-button.active { background-color: #047857; font-weight: 600; }
        .carousel-container { position: relative; overflow: hidden; border-radius: 8px; }
        .carousel-track { display: flex; transition: transform 0.5s ease-in-out; }
        .carousel-slide { min-width: 100%; box-sizing: border-box; display: flex; justify-content: center; align-items: center; height: 300px; background-size: cover; background-position: center; color: white; font-size: 2rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .carousel-dot { width: 10px; height: 10px; background-color: rgba(255, 255, 255, 0.5); border-radius: 50%; cursor: pointer; margin: 0 5px; transition: background-color 0.3s; }
        .carousel-dot.active { background-color: white; }
        .chart-placeholder { min-height: 200px; background-color: #e0e7ff; border: 1px solid #c7d2fe; border-radius: 8px; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #4338ca; font-weight: 500; text-align: center; padding: 1rem; }
        .gauge-container { width: 120px; height: 120px; border-radius: 50%; background-color: #cbd5e1; display: flex; justify-content: center; align-items: center; position: relative; overflow: hidden; margin: auto; }
        .gauge-fill { position: absolute; bottom: 0; left: 0; width: 100%; background-color: #22c55e; height: 50%; transition: height 0.5s ease-out, background-color 0.5s ease-out; }
        .gauge-value { position: relative; z-index: 10; font-size: 1.5rem; font-weight: bold; color: #334155; }
        .gauge-label { position: absolute; top: 10px; font-size: 0.8rem; color: #64748b; }
        @media (min-width: 640px) { .feature-cards-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (min-width: 768px) { .feature-cards-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (min-width: 1024px) { .feature-cards-grid { grid-template-columns: repeat(5, 1fr); } }
    </style>
</head>
<body class="bg-gray-100 antialiased">
    <div class="container bg-white rounded-xl shadow-lg my-8 md:my-12">
        <!-- Navigation Bar -->
        <nav class="bg-emerald-600 p-4 rounded-t-xl shadow-md">
            <ul class="flex flex-wrap justify-center gap-2 md:gap-4">
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50 active" onclick="showPage('home')">首頁</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('dashboard')">即時監測儀表板</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('automation')">智慧農業自動化控制</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('crop-management')">農作物生長管理區</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('reports-prediction')">分析報表與預測系統</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('settings')">系統設定與管理</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('mobile-design')">手機/平板互動設計</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('ai-chatbot')">AI客服Robot</button></li>
                <li><button class="nav-button bg-emerald-500 text-white px-4 py-2 rounded-md hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-opacity-50" onclick="showPage('anomaly-notification')">異常通知</button></li>
            </ul>
        </nav>
        
        <!-- =================================================================== -->
        <!-- =================== ALL PAGE CONTENT (HTML PART) ================== -->
        <!-- =================================================================== -->
        <!-- Page 1: 首頁 Home -->
        <div id="home" class="page-content active"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">智慧農業生產數據監測系統</h1><p class="text-lg text-gray-600 mb-8 text-center">讓農業生產更智慧、更高效！</p><section class="mb-10"><h2 class="text-2xl font-semibold text-gray-700 mb-4">系統簡介</h2><div class="carousel-container h-64 md:h-80"><div class="carousel-track" id="home-carousel-track"><div class="carousel-slide" style="background-image: url('https://placehold.co/1200x400/3498db/ffffff?text=智慧農場全景');"><span class="bg-black bg-opacity-50 p-2 rounded-md">智慧農場全景</span></div><div class="carousel-slide" style="background-image: url('https://placehold.co/1200x400/2ecc71/ffffff?text=先進感測器部署');"><span class="bg-black bg-opacity-50 p-2 rounded-md">先進感測器部署</span></div><div class="carousel-slide" style="background-image: url('https://placehold.co/1200x400/9b59b6/ffffff?text=自動化灑水系統');"><span class="bg-black bg-opacity-50 p-2 rounded-md">自動化灑水系統</span></div></div><div class="absolute bottom-4 left-0 right-0 flex justify-center space-x-2" id="home-carousel-dots"><span class="carousel-dot active" data-slide="0"></span><span class="carousel-dot" data-slide="1"></span><span class="carousel-dot" data-slide="2"></span></div></div></section><section class="mb-10"><h2 class="text-2xl font-semibold text-gray-700 mb-4">主要功能總覽</h2><div class="grid feature-cards-grid gap-6"><div class="bg-indigo-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('dashboard')"><div class="text-4xl mb-3 text-indigo-700">📊</div><h3 class="text-xl font-medium text-indigo-800">即時監測</h3><p class="text-gray-600 text-sm">掌握農場即時數據</p></div><div class="bg-green-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('dashboard')"><div class="text-4xl mb-3 text-green-700">🌱</div><h3 class="text-xl font-medium text-green-800">環境感測</h3><p class="text-gray-600 text-sm">溫度、濕度、土壤一覽無遺</p></div><div class="bg-red-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('automation')"><div class="text-4xl mb-3 text-red-700">⚙️</div><h3 class="text-xl font-medium text-red-800">自動化控制</h3><p class="text-gray-600 text-sm">智能管理灑水、通風</p></div><div class="bg-yellow-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('crop-management')"><div class="text-4xl mb-3 text-yellow-700">🌾</div><h3 class="text-xl font-medium text-yellow-800">農作管理</h3><p class="text-gray-600 text-sm">作物生長與照片記錄</p></div><div class="bg-purple-100 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer text-center" onclick="showPage('reports-prediction')"><div class="text-4xl mb-3 text-purple-700">📈</div><h3 class="text-xl font-medium text-purple-800">報表與預測分析</h3><p class="text-gray-600 text-sm">數據洞察，輔助決策</p></div></div></section><section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-10"><div class="bg-blue-50 p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-blue-700 mb-4">今日天氣與預測</h2><p class="text-gray-700 text-lg mb-2">農場地點：台中市后里區</p><p id="weather-temp" class="text-gray-700 text-3xl font-bold">28°C ☀️</p><p id="weather-humidity" class="text-gray-600">濕度 75%</p><p id="weather-rain" class="text-gray-600">降雨機率 10%</p><p id="weather-forecast" class="text-gray-600 text-sm mt-2">預計明日：多雲，26°C - 32°C</p></div><div class="bg-gray-50 p-6 rounded-lg shadow-md flex flex-col justify-between"><div><h2 class="text-2xl font-semibold text-gray-700 mb-4">快速入口</h2><button class="w-full bg-blue-500 text-white py-3 rounded-md mb-3 hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="showPage('dashboard')">快速進入數據儀表板</button></div><div><p class="text-center text-gray-600 mb-2">已有帳號？</p><button class="w-full border border-blue-500 text-blue-500 py-3 rounded-md hover:bg-blue-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="alert('模擬登入操作...');">登入</button><p class="text-center text-gray-600 mt-3 mb-2">還沒有帳號？</p><button class="w-full bg-blue-700 text-white py-3 rounded-md hover:bg-blue-800 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-700" onclick="alert('模擬註冊操作...');">註冊</button></div></div></section></div>
        <!-- Page 2: 即時監測儀表板 Dashboard --><div id="dashboard" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">即時監測儀表板</h1><p class="text-lg text-gray-600 mb-8 text-center">即時掌握農場環境與作物數據</p><div class="mb-6 flex flex-col md:flex-row items-center gap-4"><label for="sensor-select" class="font-medium text-gray-700">選擇感測器/區域:</label><select id="sensor-select" class="p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 flex-grow" onchange="updateDashboardCharts()"><option value="all">所有感測器</option><option value="field-a">A地塊感測器</option><option value="greenhouse-1">溫室1號</option><option value="field-b">B地塊感測器</option></select></div><section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"><div class="bg-white p-6 rounded-lg shadow-md"><h3 class="text-xl font-semibold text-gray-700 mb-3">溫度變化折線圖 (24小時)</h3><div id="temp-chart" class="chart-placeholder h-48"><p class="text-2xl text-blue-700 font-bold mb-2"><span id="current-temp">28.5</span>°C</p><p class="text-sm text-gray-600">最高: 30°C, 最低: 22°C</p><div class="w-full bg-blue-200 h-2 rounded-full mt-4 relative"><div class="bg-blue-500 h-2 rounded-full" style="width: 70%;"></div></div><p class="text-xs text-gray-500 mt-1">模擬過去24小時變化</p></div><p class="text-sm text-gray-500 mt-2">描述：顯示過去24小時的氣溫變化趨勢。</p></div><div class="bg-white p-6 rounded-lg shadow-md"><h3 class="text-xl font-semibold text-gray-700 mb-3">土壤濕度分佈熱力圖</h3><div id="soil-moisture-chart" class="chart-placeholder h-48"><p class="text-2xl text-green-700 font-bold mb-2">平均濕度: <span id="current-soil-moisture">65</span>%</p><div class="grid grid-cols-3 gap-2 w-full mt-4"><div class="h-12 rounded-md flex items-center justify-center text-white text-xs" style="background-color: hsl(120, 60%, 40%);">A區 68%</div><div class="h-12 rounded-md flex items-center justify-center text-white text-xs" style="background-color: hsl(120, 60%, 50%);">B區 60%</div><div class="h-12 rounded-md flex items-center justify-center text-white text-xs" style="background-color: hsl(120, 60%, 30%);">C區 75%</div></div></div><p class="text-sm text-gray-500 mt-2">描述：以顏色深淺展示不同地塊的土壤濕度分佈。</p></div><div class="bg-white p-6 rounded-lg shadow-md"><h3 class="text-xl font-semibold text-gray-700 mb-3">日照強度長條圖 (每小時)</h3><div id="sunlight-chart" class="chart-placeholder h-48"><p class="text-2xl text-yellow-700 font-bold mb-2">目前日照: <span id="current-sunlight">8500</span> Lux</p><div class="flex justify-around items-end w-full h-24 mt-4"><div class="bg-yellow-400 w-4 rounded-t-sm" style="height: 60%;" title="10點: 7500 Lux"></div><div class="bg-yellow-400 w-4 rounded-t-sm" style="height: 80%;" title="11點: 9000 Lux"></div><div class="bg-yellow-500 w-4 rounded-t-sm" style="height: 95%;" title="12點: 10000 Lux"></div><div class="bg-yellow-400 w-4 rounded-t-sm" style="height: 85%;" title="13點: 9200 Lux"></div><div class="bg-yellow-400 w-4 rounded-t-sm" style="height: 70%;" title="14點: 8000 Lux"></div><div class="bg-yellow-300 w-4 rounded-t-sm" style="height: 40%;" title="15點: 5000 Lux"></div></div></div><p class="text-sm text-gray-500 mt-2">描述：顯示每小時的平均日照強度。</p></div><div class="bg-white p-6 rounded-lg shadow-md flex flex-col items-center justify-center"><h3 class="text-xl font-semibold text-gray-700 mb-3">CO₂濃度儀表板</h3><div class="gauge-container mb-2"><div class="gauge-fill" id="co2-gauge-fill" style="height: 65%; background-color: #facc15;"></div><span class="gauge-value" id="co2-value">550 ppm</span><span class="gauge-label">CO₂</span></div><p class="text-sm text-gray-500 mt-2">描述：即時顯示溫室內二氧化碳濃度。</p></div></section><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">農場感測點位置</h2><div class="relative bg-gray-200 h-64 rounded-md flex justify-center items-center text-gray-500 text-lg"><img src="https://placehold.co/800x300/e0e0e0/555555?text=農場地圖示意圖" alt="農場地圖示意圖" class="w-full h-full object-cover rounded-md" onerror="this.onerror=null;this.src='https://placehold.co/800x300/e0e0e0/555555?text=地圖載入失敗';"><div class="absolute top-1/4 left-1/4 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold cursor-pointer" title="感測點 A" onclick="showSensorDetail('A', '氣溫: 27°C, 土壤濕度: 68%, 日照: 8500 Lux');">A</div><div class="absolute bottom-1/3 right-1/3 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold cursor-pointer" title="感測點 B" onclick="showSensorDetail('B', '氣溫: 26°C, 土壤濕度: 72%, 日照: 7800 Lux');">B</div></div><p class="text-sm text-gray-500 mt-2">描述：地圖上顯示各感測器的地理位置，點擊可查看該點詳細數據。</p></section><section class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">更多數據查詢</h2><div class="grid grid-cols-1 md:grid-cols-3 gap-4"><button class="bg-blue-100 text-blue-700 py-3 rounded-md hover:bg-blue-200 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="alert('顯示感測器列表及狀態：\n- SENS-001 (正常)\n- SENS-002 (正常)\n- SENS-003 (離線)\n- SENS-004 (正常)');">感測器列表 / 狀態圖示</button><div class="flex flex-col"><input type="text" placeholder="指定日期區間 (YYYY-MM-DD)" class="p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 mb-2" value="2025-06-01 ~ 2025-06-30"><button class="bg-blue-100 text-blue-700 py-3 rounded-md hover:bg-blue-200 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="alert('查詢指定日期區間數據 (2025-06-01 ~ 2025-06-30)。\n顯示該期間的數據總結與趨勢。');">數據查詢</button></div><button class="bg-red-100 text-red-700 py-3 rounded-md hover:bg-red-200 transition-colors focus:outline-none focus:ring-2 focus:ring-red-500" onclick="alert('顯示警示紀錄：\n- 2025-06-25 15:00: 高溫警報 (35°C)\n- 2025-06-20 10:00: 土壤濕度過低警報 (15%)\n- 2025-06-18 08:00: 感測器 SENS-003 離線');">警示紀錄</button></div></section></div>
        <!-- Page 3: 智慧農業自動化控制 --><div id="automation" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">智慧農業自動化控制</h1><p class="text-lg text-gray-600 mb-8 text-center">智能設備管理，提升生產效率</p><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">設備控制地圖</h2><div class="relative bg-gray-200 h-64 rounded-md flex justify-center items-center text-gray-500 text-lg"><img src="https://placehold.co/800x300/c7d2fe/4338ca?text=設備部署地圖" alt="設備部署地圖" class="w-full h-full object-cover rounded-md" onerror="this.onerror=null;this.src='https://placehold.co/800x300/c7d2fe/4338ca?text=地圖載入失敗';"><div id="sprinkler-a" class="absolute top-1/4 left-1/4 w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white text-2xl font-bold cursor-pointer" title="灑水器 A (狀態: 開啟)" data-device="灑水器 A" data-status="開啟" onclick="showControlModal(this);">💧</div><div id="fan-1" class="absolute top-1/2 right-1/4 w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white text-2xl font-bold cursor-pointer" title="排風扇 1 (狀態: 關閉)" data-device="排風扇 1" data-status="關閉" onclick="showControlModal(this);">🌬️</div><div id="led-light-2" class="absolute bottom-1/4 left-1/2 w-10 h-10 bg-yellow-500 rounded-full flex items-center justify-center text-white text-2xl font-bold cursor-pointer" title="LED 補光燈 2 (狀態: 自動)" data-device="LED 補光燈 2" data-status="自動" onclick="showControlModal(this);">💡</div></div><p class="text-sm text-gray-500 mt-2">描述：點擊地圖上的設備圖示，可開啟對應的控制介面。</p></section><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">自動化條件設定</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="device-select-auto" class="block text-gray-700 text-sm font-bold mb-2">選擇設備:</label><select id="device-select-auto" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-blue-500 focus:border-blue-500"><option value="sprinkler">灑水器</option><option value="fan">排風扇</option><option value="light">LED 補光燈</option><option value="drip">滴灌系統</option></select></div><div><label for="mode-toggle" class="block text-gray-700 text-sm font-bold mb-2">控制模式:</label><div class="flex items-center space-x-4"><input type="radio" id="mode-auto" name="control-mode" value="自動" checked class="form-radio text-blue-600 h-5 w-5"><label for="mode-auto" class="text-gray-700">自動</label><input type="radio" id="mode-manual" name="control-mode" value="手動" class="form-radio text-blue-600 h-5 w-5"><label for="mode-manual" class="text-gray-700">手動</label></div></div></div><div class="mt-6 p-4 border border-blue-200 bg-blue-50 rounded-md"><h3 class="text-lg font-semibold text-blue-800 mb-3">設定自動化規則 (範例)</h3><div class="flex flex-wrap items-center gap-3 mb-3"><span class="text-gray-700">當</span><select id="condition1-param" class="p-2 border rounded-md"><option value="temp">溫度</option><option value="humidity">濕度</option><option value="soil">土壤濕度</option><option value="light">日照</option></select><select id="condition1-op" class="p-2 border rounded-md"><option value=">">></option><option value="<"><</option><option value="=">=</option></select><input type="number" id="condition1-value" placeholder="數值" class="p-2 border rounded-md w-24" value="30"><span class="text-gray-700">°C 且</span><select id="condition2-param" class="p-2 border rounded-md"><option value="humidity">濕度</option><option value="temp">溫度</option></select><select id="condition2-op" class="p-2 border rounded-md"><option value="<"><</option><option value=">">></option><option value="=">=</option></select><input type="number" id="condition2-value" placeholder="數值" class="p-2 border rounded-md w-24" value="40"><span class="text-gray-700">% 則</span><select id="action-device" class="p-2 border rounded-md"><option value="sprinkler">自動灑水</option><option value="fan">開啟排風扇</option><option value="light">開啟補光燈</option></select></div><button class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="saveAutomationCondition();">儲存條件</button></div></section><section class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">操作歷史紀錄</h2><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">時間</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">設備</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">動作</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">模式</th></tr></thead><tbody id="operation-history-table" class="bg-white divide-y divide-gray-200"><tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-06-28 14:30</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">灑水器 A</td><td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">開啟</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">自動</td></tr><tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-06-28 10:00</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">排風扇 1</td><td class="px-6 py-4 whitespace-nowrap text-sm text-red-600">關閉</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">手動</td></tr><tr><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-06-27 20:00</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">LED 補光燈 2</td><td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">開啟</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">自動</td></tr></tbody></table></div></section><div id="controlModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50"><div class="bg-white p-8 rounded-lg shadow-xl w-96"><h3 class="text-2xl font-bold mb-4" id="modalTitle"></h3><p class="mb-2 text-gray-700">您正在控制 <span id="modalDeviceName" class="font-semibold text-blue-700"></span>。</p><p class="mb-6 text-gray-700">目前狀態: <span id="modalDeviceStatus" class="font-semibold text-gray-700"></span></p><div class="flex justify-around mb-6"><button class="bg-green-500 text-white px-6 py-3 rounded-md hover:bg-green-600 transition-colors" onclick="controlDevice('開啟');">開啟</button><button class="bg-red-500 text-white px-6 py-3 rounded-md hover:bg-red-600 transition-colors" onclick="controlDevice('關閉');">關閉</button></div><button class="w-full bg-gray-200 text-gray-700 py-2 rounded-md hover:bg-gray-300 transition-colors" onclick="hideControlModal()">取消</button></div></div></div>
        <!-- Page 4: 農作物生長管理區 --><div id="crop-management" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">農作物生長管理區</h1><p class="text-lg text-gray-600 mb-8 text-center">追蹤農作物生長歷程與關鍵紀錄</p><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">各區塊農作紀錄</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-gray-50 p-4 rounded-md border border-gray-200"><h3 class="text-xl font-medium text-gray-800 mb-2">地塊 A - 玉米</h3><p class="text-gray-600 text-sm mb-1">播種日期：2025-03-15</p><p class="text-gray-600 text-sm mb-1">施肥紀錄：2025-04-01 (有機肥), 2025-05-10 (N-P-K)</p><p class="text-gray-600 text-sm">預計採收：2025-07-20</p><textarea id="crop-record-a" class="mt-3 w-full p-2 border border-gray-300 rounded-md" rows="3" placeholder="添加更多記錄..."></textarea><button class="mt-2 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors text-sm" onclick="saveCropRecord('地塊 A', document.getElementById('crop-record-a').value);">儲存紀錄</button></div><div class="bg-gray-50 p-4 rounded-md border border-gray-200"><h3 class="text-xl font-medium text-gray-800 mb-2">溫室 1 - 草莓</h3><p class="text-gray-600 text-sm mb-1">定植日期：2025-01-20</p><p class="text-gray-600 text-sm mb-1">施肥紀錄：每週滴灌營養液</p><p class="text-gray-600 text-sm">已採收批次：5</p><textarea id="crop-record-b" class="mt-3 w-full p-2 border border-gray-300 rounded-md" rows="3" placeholder="添加更多記錄..."></textarea><button class="mt-2 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors text-sm" onclick="saveCropRecord('溫室 1', document.getElementById('crop-record-b').value);">儲存紀錄</button></div></div></section><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">田間圖像管理</h2><div class="grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-6"><img src="https://placehold.co/100x100/A0DA8C/FFFFFF?text=D1" alt="作物照片 2025-05-01" class="w-full h-24 object-cover rounded-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showImageDetail('https://placehold.co/600x400/A0DA8C/FFFFFF?text=2025-05-01+作物高度20cm', '2025-05-01', '氣溫: 25.1°C, 土壤濕度: 60%, PH: 6.5');"><img src="https://placehold.co/100x100/7DB95C/FFFFFF?text=D2" alt="作物照片 2025-05-08" class="w-full h-24 object-cover rounded-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showImageDetail('https://placehold.co/600x400/7DB95C/FFFFFF?text=2025-05-08+作物高度28cm', '2025-05-08', '氣溫: 27.3°C, 土壤濕度: 55%, PH: 6.7');"><img src="https://placehold.co/100x100/5E9A3E/FFFFFF?text=D3" alt="作物照片 2025-05-15" class="w-full h-24 object-cover rounded-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showImageDetail('https://placehold.co/600x400/5E9A3E/FFFFFF?text=2025-05-15+作物高度35cm', '2025-05-15', '氣溫: 26.8°C, 土壤濕度: 62%, PH: 6.6');"><img src="https://placehold.co/100x100/4F8A32/FFFFFF?text=D4" alt="作物照片 2025-05-22" class="w-full h-24 object-cover rounded-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showImageDetail('https://placehold.co/600x400/4F8A32/FFFFFF?text=2025-05-22+作物高度42cm', '2025-05-22', '氣溫: 28.0°C, 土壤濕度: 58%, PH: 6.8');"><img src="https://placehold.co/100x100/3E7A2E/FFFFFF?text=D5" alt="作物照片 2025-05-29" class="w-full h-24 object-cover rounded-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showImageDetail('https://placehold.co/600x400/3E7A2E/FFFFFF?text=2025-05-29+作物高度50cm', '2025-05-29', '氣溫: 29.2°C, 土壤濕度: 59%, PH: 6.9');"><img src="https://placehold.co/100x100/2D6A1E/FFFFFF?text=D6" alt="作物照片 2025-06-05" class="w-full h-24 object-cover rounded-md cursor-pointer hover:shadow-lg transition-shadow" onclick="showImageDetail('https://placehold.co/600x400/2D6A1E/FFFFFF?text=2025-06-05+作物高度58cm', '2025-06-05', '氣溫: 27.5°C, 土壤濕度: 65%, PH: 6.7');"></div><p class="text-sm text-gray-500 mt-2">描述：點選小縮圖，將顯示該日期的放大圖片與疊加的環境數據。</p><button class="mt-4 bg-purple-500 text-white px-4 py-2 rounded-md hover:bg-purple-600 transition-colors text-sm" onclick="simulateGifGeneration();">生成週成長GIF紀錄</button></section><div id="imageDetailModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center hidden z-50"><div class="bg-white p-6 rounded-lg shadow-xl max-w-2xl w-full"><img id="modalImage" src="" alt="作物詳情照片" class="w-full h-auto rounded-md mb-4"><p class="text-lg font-semibold text-gray-800" id="modalImageDate"></p><p class="text-gray-600 mb-4" id="modalImageData"></p><button class="w-full bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 transition-colors" onclick="hideImageDetailModal()">關閉</button></div></div><section class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">作物成長曲線圖</h2><div id="growth-chart" class="chart-placeholder h-64"><p class="text-2xl text-purple-700 font-bold mb-2">作物平均高度: <span id="current-crop-height">55</span> cm</p><div class="flex justify-around items-end w-full h-48 mt-4"><div class="bg-purple-300 w-6 rounded-t-sm" style="height: 40%;" title="第2週: 20cm"></div><div class="bg-purple-400 w-6 rounded-t-sm" style="height: 55%;" title="第3週: 28cm"></div><div class="bg-purple-500 w-6 rounded-t-sm" style="height: 70%;" title="第4週: 35cm"></div><div class="bg-purple-600 w-6 rounded-t-sm" style="height: 85%;" title="第5週: 42cm"></div><div class="bg-purple-700 w-6 rounded-t-sm" style="height: 95%;" title="第6週: 50cm"></div></div><p class="text-xs text-gray-500 mt-1">模擬作物高度成長趨勢</p></div><p class="text-sm text-gray-500 mt-2">描述：追蹤作物高度、葉片數量等生長指標的變化曲線。</p></section></div>
        <!-- Page 5: 分析報表與預測系統 --><div id="reports-prediction" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">分析報表與預測系統</h1><p class="text-lg text-gray-600 mb-8 text-center">透過數據分析與預測，優化生產決策</p><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">統計報表產生</h2><div class="flex flex-wrap gap-4 mb-4"><div class="flex-1 min-w-[200px]"><label for="report-type" class="block text-gray-700 text-sm font-bold mb-2">報表類型:</label><select id="report-type" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-blue-500 focus:border-blue-500"><option value="生產量報表">生產量報表</option><option value="用水用電報表">用水用電報表</option><option value="感測數據總結">感測數據總結</option></select></div><div class="flex-1 min-w-[200px]"><label for="report-start-date" class="block text-gray-700 text-sm font-bold mb-2">開始日期:</label><input type="date" id="report-start-date" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-blue-500 focus:border-blue-500" value="2025-06-01"></div><div class="flex-1 min-w-[200px]"><label for="report-end-date" class="block text-gray-700 text-sm font-bold mb-2">結束日期:</label><input type="date" id="report-end-date" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-blue-500 focus:border-blue-500" value="2025-06-30"></div></div><div class="flex gap-4"><button class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="simulateReportDownload('PDF');">下載 PDF</button><button class="bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500" onclick="simulateReportDownload('Excel');">下載 Excel</button></div></section><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">預測模型</h2><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><h3 class="text-xl font-medium text-gray-800 mb-2">下一週灌溉需求預測</h3><div id="irrigation-prediction-chart" class="chart-placeholder h-48 mb-3"><p class="text-2xl text-blue-700 font-bold mb-2"><span id="predicted-irrigation">1500</span> 公升/公頃</p><p class="text-sm text-gray-600">預測趨勢: <span id="irrigation-trend">穩定</span></p></div><p class="text-gray-600">根據氣候模型和作物生長階段，預計未來一週灌溉需求量為 <span id="predicted-irrigation-value" class="font-bold text-blue-700">1500 公升/公頃</span>。</p><p class="text-sm text-gray-500 mt-1">建議：週三和週六進行主要灌溉。</p><button class="mt-2 bg-indigo-500 text-white px-3 py-1 rounded-md text-sm hover:bg-indigo-600" onclick="updatePredictions()">更新預測</button></div><div><h3 class="text-xl font-medium text-gray-800 mb-2">預測收成量</h3><div id="yield-prediction-chart" class="chart-placeholder h-48 mb-3"><p class="text-2xl text-green-700 font-bold mb-2"><span id="predicted-yield">5.2</span> 噸/公頃</p><p class="text-sm text-gray-600">預測準確度: <span id="yield-accuracy">88</span>%</p></div><p class="text-gray-600">依據作物健康度、環境數據與歷史收成紀錄，預測本季玉米收成量約為 <span id="predicted-yield-value" class="font-bold text-green-700">5.2 噸/公頃</span>。</p><p class="text-sm text-gray-500 mt-1">預測準確度：<span id="yield-accuracy-value">88</span>%。</p></div></div></section><section class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">常用分析圖表</h2><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="bg-blue-50 p-4 rounded-md"><h3 class="text-xl font-medium text-blue-800 mb-2">生產量月趨勢</h3><div class="chart-placeholder h-48"><p>模擬折線圖</p><p class="text-sm">趨勢: <span class="text-green-600">上升</span></p></div></div><div class="bg-green-50 p-4 rounded-md"><h3 class="text-xl font-medium text-green-800 mb-2">用水用電量</h3><div class="chart-placeholder h-48"><p>模擬雙軸圖</p><p class="text-sm">用水: 1200m³, 用電: 800kWh</p></div></div><div class="bg-purple-50 p-4 rounded-md"><h3 class="text-xl font-medium text-purple-800 mb-2">預測收成趨勢</h3><div class="chart-placeholder h-48"><p>模擬長條圖</p><p class="text-sm">預計產量: 5.2 噸/公頃</p></div></div></div></section></div>
        <!-- Page 6: 系統設定與管理 --><div id="settings" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">系統設定與管理</h1><p class="text-lg text-gray-600 mb-8 text-center">管理用戶權限、感測器與農場區域</p><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">使用者權限管理</h2><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">姓名</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">角色</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">電子郵件</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th></tr></thead><tbody id="user-management-table" class="bg-white divide-y divide-gray-200"></tbody></table></div><button class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors" onclick="addUser();">新增使用者</button></section><section class="mb-8 bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">感測器維護紀錄</h2><div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">感測器ID</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">維護日期</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">維護內容</th><th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">狀態</th></tr></thead><tbody id="sensor-maintenance-table" class="bg-white divide-y divide-gray-200"><tr><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">SENS-001</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-06-10</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">電池更換、校準</td><td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">正常</td></tr><tr><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">SENS-005</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">2025-05-20</td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">清潔探頭</td><td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">正常</td></tr></tbody></table></div><button class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors" onclick="addMaintenanceRecord();">新增維護記錄</button></section><section class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">自定義農場區域</h2><div class="bg-gray-100 h-64 rounded-md flex justify-center items-center text-gray-500 text-lg mb-4"><img src="https://placehold.co/800x300/F0F4F8/64748b?text=農場區域繪圖區" alt="農場區域繪圖區" class="w-full h-full object-cover rounded-md" onerror="this.onerror=null;this.src='https://placehold.co/800x300/F0F4F8/64748b?text=區域繪圖載入失敗';"></div><p class="text-gray-600 mb-4">您可以在此處上傳農場地圖圖片，或透過拖拉方式在地圖上劃定不同的種植區域，並為每個區域命名和設定屬性。</p><input type="file" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 mb-4" onchange="uploadFarmMap(event)"><button class="bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors" onclick="alert('模擬儲存區域設定');">儲存區域設定</button></section></div>
        <!-- Page 7: 手機版 / 平板互動設計 --><div id="mobile-design" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">手機 / 平板互動設計</h1><p class="text-lg text-gray-600 mb-8 text-center">專為行動裝置優化，隨時隨地輕鬆管理</p><div class="bg-white p-6 rounded-lg shadow-md mb-8"><h2 class="text-2xl font-semibold text-gray-700 mb-4">響應式設計</h2><p class="text-gray-700 mb-3">此系統採用 Tailwind CSS 框架，確保頁面在不同尺寸的螢幕上（手機、平板、桌面）都能自動調整佈局和元素大小，提供最佳的視覺體驗。</p><div class="flex justify-center items-center gap-6 flex-wrap"><img src="https://placehold.co/150x250/E0E7FF/4338CA?text=手機視圖" alt="手機視圖" class="rounded-lg shadow-md border border-blue-200"><img src="https://placehold.co/300x200/DBEAFE/1D4ED8?text=平板視圖" alt="平板視圖" class="rounded-lg shadow-md border border-blue-300"><img src="https://placehold.co/400x250/BFDBFE/2563EB?text=桌面視圖" alt="桌面視圖" class="rounded-lg shadow-md border border-blue-400"></div><p class="text-sm text-gray-500 mt-4">描述：圖片展示了網頁在不同設備上的適應性。</p></div><div class="bg-white p-6 rounded-lg shadow-md mb-8"><h2 class="text-2xl font-semibold text-gray-700 mb-4">功能重點 (行動版)</h2><ul class="list-disc list-inside text-gray-700 space-y-3"><li><strong class="text-blue-700">圖片與數據同步切換:</strong> 在手機或平板上瀏覽田間照片時，點擊圖片會自動疊加顯示該照片拍攝時的環境數據（如氣溫、濕度、日照等），提供更直觀的上下文資訊。</li><li><strong class="text-blue-700">地圖點擊 + 拍照上傳功能 (巡檢回報):</strong> 農場巡檢人員可直接在行動裝置的地圖介面上點擊任一感測點或區域，並利用手機攝像頭即時拍照上傳，同時附帶文字備註，用於記錄異常狀況或作物生長情況，即時回報至系統。<button class="ml-2 bg-blue-100 text-blue-700 px-3 py-1 rounded-md text-sm hover:bg-blue-200" onclick="alert('模擬開啟相機並上傳照片至地圖點位...');">模擬拍照上傳</button></li><li><strong class="text-blue-700">推播功能 (異常警報):</strong> 當系統監測到異常情況（如高溫、乾旱警報、設備故障）時，會立即透過行動應用程式或網頁瀏覽器向管理員和相關農夫推播通知，確保問題能被迅速發現與處理。<button class="ml-2 bg-red-100 text-red-700 px-3 py-1 rounded-md text-sm hover:bg-red-200" onclick="alert('模擬發送異常警報推播通知：\n「警告！溫室1號溫度過高 (38°C)。」');">模擬推播警報</button></li><li><strong class="text-blue-700">簡化操作介面:</strong> 行動版介面會針對觸控操作進行優化，按鈕和輸入框更大，流程更簡潔，方便單手操作。</li><li><strong class="text-blue-700">離線數據緩存 (概念):</strong> 考慮到農場可能網路不穩，未來可實作部分數據離線緩存功能，確保在無網路情況下仍能查看基礎數據和記錄。</li></ul></div><div class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">預期效益</h2><p class="text-gray-700">行動版設計將極大提升系統的實用性和便捷性，讓農場管理人員能夠隨時隨地掌握農場狀況，快速響應問題，實現真正的智慧化農業生產。</p></div></div>
        <!-- Page 8: AI客服Robot --><div id="ai-chatbot" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">AI客服Robot</h1><p class="text-lg text-gray-600 mb-8 text-center">您的智慧農業助理，隨時提供幫助！</p><div class="bg-white p-6 rounded-lg shadow-md h-[500px] flex flex-col"><div id="chat-messages" class="flex-1 overflow-y-auto border border-gray-200 rounded-md p-4 mb-4 space-y-4"><div class="flex justify-start"><div class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg max-w-xs">您好！我是您的AI客服，請問有什麼可以協助您的嗎？您可以問我關於「溫度」、「灑水」或「預測收成」的問題。</div></div></div><div class="flex"><input type="text" id="chat-input" class="flex-1 p-3 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-emerald-500" placeholder="輸入您的問題..."><button class="bg-emerald-500 text-white px-6 py-3 rounded-r-md hover:bg-emerald-600 transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500" onclick="sendChatMessage()">發送</button></div></div><p class="text-sm text-gray-500 mt-4 text-center">描述：AI客服Robot可以回答關於農場數據、設備操作、作物管理等問題。</p></div>
        <!-- Page 9: Anomaly Notification (異常通知) --><div id="anomaly-notification" class="page-content"><h1 class="text-4xl font-bold text-gray-800 mb-6 text-center">異常通知設定</h1><p class="text-lg text-gray-600 mb-8 text-center">管理異常事件的通知方式，確保您能即時收到重要資訊。</p><section class="bg-white p-6 rounded-lg shadow-md mb-8"><h2 class="text-2xl font-semibold text-gray-700 mb-4">Line@ 串接設定</h2><p class="text-gray-700 mb-6">透過串接 Line@ 官方帳號，您可以將系統的異常通知即時發送到您的 Line 訊息中。</p><div class="space-y-4"><div><label for="line-channel-id" class="block text-gray-700 text-sm font-bold mb-2">Line Channel ID:</label><input type="text" id="line-channel-id" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-emerald-500 focus:border-emerald-500" placeholder="請輸入您的 Line Channel ID"></div><div><label for="line-channel-secret" class="block text-gray-700 text-sm font-bold mb-2">Line Channel Secret:</label><input type="password" id="line-channel-secret" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-emerald-500 focus:border-emerald-500" placeholder="請輸入您的 Line Channel Secret"></div><div><label for="line-access-token" class="block text-gray-700 text-sm font-bold mb-2">Line Access Token:</label><input type="password" id="line-access-token" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline focus:ring-emerald-500 focus:border-emerald-500" placeholder="請輸入您的 Line Access Token"></div><div class="flex items-center"><input type="checkbox" id="enable-line-notify" class="form-checkbox h-5 w-5 text-emerald-600 rounded"><label for="enable-line-notify" class="ml-2 text-gray-700">啟用 Line 通知</label></div></div><div class="mt-8 flex justify-end gap-4"><button class="bg-gray-300 text-gray-800 px-6 py-3 rounded-md hover:bg-gray-400 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500" onclick="resetLineSettings()">重設</button><button class="bg-emerald-500 text-white px-6 py-3 rounded-md hover:bg-emerald-600 transition-colors focus:outline-none focus:ring-2 focus:ring-emerald-500" onclick="saveLineSettings()">儲存設定</button></div></section><section class="bg-white p-6 rounded-lg shadow-md"><h2 class="text-2xl font-semibold text-gray-700 mb-4">測試通知</h2><p class="text-gray-700 mb-4">儲存設定後，您可以發送一則測試訊息到您的 Line 帳號，以確認串接是否成功。</p><button class="bg-blue-500 text-white px-6 py-3 rounded-md hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500" onclick="testLineNotification()">發送測試通知</button></section></div>
    </div>

    <!-- =================================================================== -->
    <!-- ============ 我是驅動所有互動功能的核心 JavaScript ============== -->
    <!-- =================================================================== -->
    <script>
        let currentActiveDevice=null,deviceStatuses={ "灑水器 A":"開啟","排風扇 1":"關閉","LED 補光燈 2":"自動"};function getCurrentFormattedTime(){const e=new Date,t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),o=e.getDate().toString().padStart(2,"0"),a=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0");return`${t}-${n}-${o} ${a}:${i}`}function showPage(e){document.querySelectorAll(".page-content").forEach(e=>{e.classList.remove("active")}),document.getElementById(e).classList.add("active"),document.querySelectorAll(".nav-button").forEach(t=>{t.classList.remove("active"),t.getAttribute("onclick")===`showPage('${e}')`&&t.classList.add("active")}),"dashboard"===e&&updateDashboardCharts()}let currentSlide=0;const carouselTrack=document.getElementById("home-carousel-track"),carouselDotsContainer=document.getElementById("home-carousel-dots"),totalSlides=carouselTrack?carouselTrack.children.length:0;function updateCarousel(){carouselTrack&&(carouselTrack.style.transform=`translateX(-${100*currentSlide}%)`,carouselDotsContainer.querySelectorAll(".carousel-dot").forEach((e,t)=>{e.classList.toggle("active",t===currentSlide)}))}function nextSlide(){currentSlide=(currentSlide+1)%totalSlides,updateCarousel()}function startCarousel(){totalSlides>0&&setInterval(nextSlide,5e3)}carouselDotsContainer&&carouselDotsContainer.querySelectorAll(".carousel-dot").forEach(e=>{e.addEventListener("click",e=>{currentSlide=parseInt(e.target.dataset.slide),updateCarousel()})});function updateWeather(){const e=(25+5*Math.random()).toFixed(1),t=(60+20*Math.random()).toFixed(0),n=(30*Math.random()).toFixed(0),o=e>28?"☀️":"☁️";document.getElementById("weather-temp").innerText=`${e}°C ${o}`,document.getElementById("weather-humidity").innerText=`濕度 ${t}%`,document.getElementById("weather-rain").innerText=`降雨機率 ${n}%`,document.getElementById("weather-forecast").innerText=`預計明日：${Math.random()>.5?"晴時多雲":"局部陣雨"}，${(parseFloat(e)-2).toFixed(0)}°C - ${(parseFloat(e)+3).toFixed(0)}°C`}function updateDashboardCharts(){const e="all"===document.getElementById("sensor-select").value?1:Math.random()+.5;document.getElementById("current-temp").innerText=(25+5*Math.random()*e).toFixed(1),document.querySelector("#temp-chart .bg-blue-500").style.width=`${30*Math.random()+50}%`,document.getElementById("current-soil-moisture").innerText=(50+25*Math.random()*e).toFixed(0),document.querySelectorAll("#soil-moisture-chart .h-12").forEach(e=>{const t=(50+25*Math.random()).toFixed(0);e.style.backgroundColor=`hsl(120, 60%, ${70-.8*(t-50)}%)`,e.innerText=`${e.innerText.split(" ")[0]} ${t}%`}),document.getElementById("current-sunlight").innerText=(5e3+5e3*Math.random()*e).toFixed(0),document.querySelectorAll("#sunlight-chart .h-24 div").forEach(e=>{e.style.height=`${60*Math.random()+30}%`});const t=(400+300*Math.random()*e).toFixed(0);document.getElementById("co2-value").innerText=`${t} ppm`;const n=document.getElementById("co2-gauge-fill");n.style.height=`${Math.min(100,(t-300)/4)}%`;let o="#22c55e";t>650?o="#ef4444":t>550&&(o="#facc15"),n.style.backgroundColor=o}function showSensorDetail(e,t){alert(`感測點 ${e} 詳細數據:\n${t}`)}function showControlModal(e){const t=e.dataset.device,n=deviceStatuses[t]||"未知";currentActiveDevice=e,document.getElementById("modalTitle").innerText=`${t} 控制`,document.getElementById("modalDeviceName").innerText=t,document.getElementById("modalDeviceStatus").innerText=n,document.getElementById("controlModal").classList.remove("hidden")}function hideControlModal(){document.getElementById("controlModal").classList.add("hidden"),currentActiveDevice=null}function controlDevice(e){currentActiveDevice&&(deviceStatuses[currentActiveDevice.dataset.device]=e,currentActiveDevice.title=`${currentActiveDevice.dataset.device} (狀態: ${e})`,addOperationHistory(currentActiveDevice.dataset.device,e,document.querySelector('input[name="control-mode"]:checked').value),alert(`${currentActiveDevice.dataset.device} 已 ${e}！`),hideControlModal())}function addOperationHistory(e,t,n){const o=document.getElementById("operation-history-table").insertRow(0);o.innerHTML=`\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${getCurrentFormattedTime()}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${e}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm ${"開啟"===t?"text-green-600":"text-red-600"}">${t}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${n}</td>\n            `}function saveAutomationCondition(){const e=document.getElementById("condition1-param").selectedOptions[0].text,t=document.getElementById("condition1-op").value,n=document.getElementById("condition1-value").value,o=document.getElementById("action-device").selectedOptions[0].text;alert(`自動化條件已儲存：\n當 ${e} ${t} ${n}，則「${o}」。`)}function saveCropRecord(e,t){""!==t.trim()?alert(`${e} 的農作記錄已儲存：\n"${t}"`):alert(`請輸入 ${e} 的農作記錄內容。`)}function showImageDetail(e,t,n){document.getElementById("modalImage").src=e,document.getElementById("modalImageDate").innerText=`日期: ${t}`,document.getElementById("modalImageData").innerText=`數據: ${n}`,document.getElementById("imageDetailModal").classList.remove("hidden")}function hideImageDetailModal(){document.getElementById("imageDetailModal").classList.add("hidden")}function simulateGifGeneration(){alert("正在生成作物週成長GIF紀錄，這可能需要一些時間..."),setTimeout(()=>{alert("作物週成長GIF紀錄已生成並可下載！(模擬下載)")},3e3)}function simulateReportDownload(e){const t=document.getElementById("report-type").value,n=document.getElementById("report-start-date").value,o=document.getElementById("report-end-date").value;alert(`正在生成 ${n} 至 ${o} 的「${t}」${e} 報表...\n請稍候...`),setTimeout(()=>{alert(`「${t}」 ${e} 報表已生成並下載完成！`)},2e3)}function updatePredictions(){const e=(1e3+1e3*Math.random()).toFixed(0),t=Math.random()>.5?"上升":"下降";document.getElementById("predicted-irrigation").innerText=e,document.getElementById("predicted-irrigation-value").innerText=`${e} 公升/公頃`,document.getElementById("irrigation-trend").innerText=t;const n=(4.5+1.5*Math.random()).toFixed(1),o=(80+15*Math.random()).toFixed(0);document.getElementById("predicted-yield").innerText=n,document.getElementById("predicted-yield-value").innerText=`${n} 噸/公頃`,document.getElementById("yield-accuracy").innerText=`${o}`,document.getElementById("yield-accuracy-value").innerText=`${o}%`,alert("預測數據已更新！")}let users=[{name:"陳大農",role:"農夫",email:"chen@farm.com"},{name:"王技師",role:"技師",email:"wang@tech.com"},{name:"李經理",role:"管理者",email:"li@admin.com"}];function renderUsersTable(){const e=document.getElementById("user-management-table");e.innerHTML="";users.forEach(t=>{const n={農夫:"text-green-600",技師:"text-blue-600",管理者:"text-purple-600"}[t.role]||"",o=e.insertRow();o.innerHTML=`\n                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${t.name}</td>\n                    <td class="px-6 py-4 whitespace-nowrap text-sm ${n}">${t.role}</td>\n                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${t.email}</td>\n                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">\n                        <a href="#" class="text-indigo-600 hover:text-indigo-900 mr-4" onclick="editUser('${t.name}'); return false;">編輯</a>\n                        <a href="#" class="text-red-600 hover:text-red-900" onclick="deleteUser('${t.name}'); return false;">刪除</a>\n                    </td>\n                `})}function addUser(){const e=prompt("請輸入新使用者的姓名:");if(e){if(users.some(t=>t.name===e))return void alert("錯誤：此使用者名稱已存在！");const t=prompt(`請輸入 ${e} 的角色 (農夫/技師/管理者):`,"農夫");if(t){const n=prompt(`請輸入 ${e} 的電子郵件:`);n&&(users.push({name:e,role:t,email:n}),renderUsersTable(),alert(`使用者 ${e} (${t}) 已新增。`))}}}function editUser(e){const t=users.findIndex(t=>t.name===e);if(-1!==t){const n=users[t],o=prompt(`編輯 ${e} 的角色 (目前: ${n.role})，請輸入新角色:`,n.role);if(o){const a=prompt(`編輯 ${e} 的電子郵件 (目前: ${n.email})，請輸入新電子郵件:`,n.email);a&&(users[t]={...n,role:o,email:a},renderUsersTable(),alert(`使用者 ${e} 的資料已更新。`))}}}function deleteUser(e){confirm(`確定要刪除使用者 ${e} 嗎？`)&&(users=users.filter(t=>t.name!==e),renderUsersTable(),alert(`使用者 ${e} 已刪除。`))}function addMaintenanceRecord(){const e=prompt("請輸入感測器ID (例如: SENS-007):");if(e){const t=prompt("請輸入維護內容:");if(t){const n=document.getElementById("sensor-maintenance-table").insertRow(0);n.innerHTML=`\n                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${e}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${getCurrentFormattedTime().split(" ")[0]}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${t}</td>\n                <td class="px-6 py-4 whitespace-nowrap text-sm text-green-600">正常</td>\n            `,alert(`感測器 ${e} 的維護記錄已新增。`)}}}function uploadFarmMap(e){const t=e.target.files[0];t&&alert(`已選取檔案: ${t.name}。\n(模擬上傳農場地圖)`)}function sendChatMessage(){const e=document.getElementById("chat-input"),t=e.value.trim();if(""!==t){const n=document.getElementById("chat-messages");n.innerHTML+=`<div class="flex justify-end"><div class="bg-emerald-100 text-emerald-800 px-4 py-2 rounded-lg max-w-xs">${t}</div></div>`,e.value="",n.scrollTop=n.scrollHeight,setTimeout(()=>{let e="對不起，我還在學習中，目前無法理解您的問題。";t.includes("溫度")||t.includes("氣溫")?e="目前的平均氣溫是 28.5°C。您可以前往「即時監測儀表板」查看詳細數據。":t.includes("灑水")||t.includes("灌溉")?e="您想自動灑水還是手動控制？請到「智慧農業自動化控制」頁面進行操作。":t.includes("收成")||t.includes("預測")?e="根據最新的模型，預測本季玉米收成量約為 5.2 噸/公頃。更多資訊請看「分析報表與預測系統」。":t.includes("你好")||t.includes("哈囉")&&(e="您好！很高興為您服務。"),n.innerHTML+=`<div class="flex justify-start"><div class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg max-w-xs">${e}</div></div>`,n.scrollTop=n.scrollHeight},1e3)}}function saveLineSettings(){const e=document.getElementById("line-channel-id").value;if(!e)return void alert("請至少填寫 Line Channel ID。");const t=document.getElementById("enable-line-notify").checked;alert(`Line@ 串接設定已儲存：\nChannel ID: ${e}\n啟用通知: ${t?"是":"否"}\n(Secret 和 Token 已於後端安全儲存)`)}function resetLineSettings(){confirm("確定要重設所有 Line@ 串接設定嗎？")&&(document.getElementById("line-channel-id").value="",document.getElementById("line-channel-secret").value="",document.getElementById("line-access-token").value="",document.getElementById("enable-line-notify").checked=!1,alert("Line@ 串接設定已重設。"))}function testLineNotification(){document.getElementById("line-channel-id").value?alert("正在發送測試通知至您的 Line 帳號...\n(模擬發送成功，請檢查您的 Line)"):alert("請先填寫並儲存 Line Channel ID。")}window.onload=function(){startCarousel(),updateWeather(),setInterval(updateWeather,6e4),setInterval(updateDashboardCharts,5e3),showPage("home"),renderUsersTable(),document.getElementById("chat-input").addEventListener("keypress",function(e){"Enter"===e.key&&sendChatMessage()})};
    </script>
</body>
</html>
